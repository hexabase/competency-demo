# 実装計画書

## 1. プロジェクト概要

社員の能力を可視化し、個々のキャリアプランに合わせたフィードバックを提供する Web アプリケーションを開発する。
ユーザーは 30 の質問に回答することで、自身のコンピテンシー（能力）をレーダーチャートで確認できる。
AI による評価コメントや、推奨される研修・書籍などの情報も提供し、社員の成長をサポートする。

## 2. 技術スタック

- **フロントエンド**: Next.js (TypeScript)
- **バックエンド**: Python (FastAPI)
- **データベース**: MySQL
- **インフラ**:
  - **開発環境**: Docker, Docker Compose
  - **本番環境**: Kubernetes

## 3. プロジェクト構成

```
.
├── .vscode/         # VSCode設定
├── backend/         # バックエンド (Python, FastAPI)
│   ├── app/
│   │   ├── crud/
│   │   ├── models/
│   │   ├── schemas/
│   │   ├── core/
│   │   └── main.py
│   ├── Dockerfile
│   └── requirements.txt
├── frontend/        # フロントエンド (Next.js)
│   ├── app/
│   ├── components/
│   ├── hooks/
│   └── lib/
├── docker-compose.yml # 開発環境定義
├── Makefile           # 開発用コマンド
└── 実装計画.md       # このファイル
```

## 4. データベース設計 (MySQL)

ER 図や詳細なテーブル定義は別途行うが、主要なテーブルは以下を想定する。

- **users (社員)**
  - `id`, `name`, `email`, `password_hash`, `created_at`
- **questions (質問)**
  - `id`, `text`, `competency_item_id`
- **competency_items (評価項目)**
  - `id`, `name`, `description`
- **answers (回答)**
  - `id`, `user_id`, `question_id`, `score`, `submitted_at`
- **user_competencies (個人のコンピテンシー結果)**
  - `id`, `user_id`, `competency_item_id`, `score`
- **company_average_competencies (全社平均)**
  - `id`, `competency_item_id`, `average_score`
- **user_career_plans (キャリアプラン)**
  - `id`, `user_id`, `strengths`, `weaknesses`, `goals`

## 5. バックエンド実装 (Python / FastAPI)

FastAPI を使用し、責務ごとにファイルを分割して実装する。

### API エンドポイント案

- `POST /api/v1/users`: ユーザー登録
- `POST /api/v1/login`: ログイン
- `GET /api/v1/questions`: 質問一覧取得
- `POST /api/v1/answers`: 回答一括送信
- `GET /api/v1/results/{user_id}`: 評価結果取得
- `POST /api/v1/career_plans`: キャリアプラン登録・更新
- `GET /api/v1/career_plans/{user_id}`: キャリアプラン取得

### AI 連携

- 評価結果とキャリアプランを基に、OpenAI API (GPT-4 など) を利用して評価コメント、アドバイス、推奨研修・書籍を生成する。
- `results`エンドポイント内部で AI へのリクエストを非同期に処理する。

## 6. フロントエンド実装 (Next.js)

App Router を利用したモダンな構成で実装する。

### ページ構成

- `/`: トップページ / ログインページ
- `/questions`: 質問回答ページ
- `/results`: 結果表示ページ
- `/career-plan`: キャリアプラン入力ページ

### コンポーネント

- `RadarChart`: `recharts` などのライブラリを利用してレーダーチャートを描画
- `Questionnaire`: 質問フォーム
- `AIFeedback`: AI が生成したコメントを表示する領域

## 7. 開発環境

- `docker-compose.yml` でバックエンド(FastAPI)、DB(MySQL)を起動する。
- `Makefile` に `up`, `down`, `build`, `ps` などのコマンドを定義し、開発体験を向上させる。

## 8. 実装ステップ

1.  **フェーズ 1: 環境構築と基本設計**
    - Git リポジトリ作成
    - `Makefile`, `docker-compose.yml` 等の環境設定
    - DB スキーマ詳細設計
    - バックエンドのプロジェクト初期化
2.  **フェーズ 2: バックエンド API 実装**
    - ユーザー認証機能の実装
    - 質問、回答に関する CRUD 処理
    - 結果算出ロジックの実装
3.  **フェーズ 3: フロントエンド実装**
    - Next.js プロジェクト初期化
    - 質問回答ページの実装
    - 結果表示ページの UI 実装（レーダーチャート含む）
4.  **フェーズ 4: AI 連携**
    - バックエンドに AI コメント生成機能を追加
    - フロントエンドに AI フィードバック表示機能を追加
5.  **フェーズ 5: キャリアプラン機能**
    - キャリアプランの登録・表示機能
    - AI 評価へのキャリアプラン反映
6.  **フェーズ 6: テストとデプロイ準備**
    - E2E テスト、単体テスト
    - Kubernetes マニフェストファイルの作成
